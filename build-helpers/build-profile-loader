#!/usr/bin/env doomscript
;; -*- lexical-binding: t; -*-

(defcli! build-profile-loader
  ((profile-name ("-n" form) "Profile name.")
   (profile-directory ("-p" dir) "Profile data directory.")
   (profile-doom-dir ("-d" dir) "DOOMDIR"))
  "Write Doom's profile loader."
  (let ((new-profiles `((,profile-name
                         (user-emacs-directory . ,doom-emacs-dir)
                         (doom-profile-data-dir . ,profile-directory)
                         ("DOOMDIR" . ,profile-doom-dir)))))
    (doom-profiles-save new-profiles)))

(run! "build-profile-loader" (cdr (member "--" argv)))
